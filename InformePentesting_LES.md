# Informe Pentesting
## **Declaración de confidencialidad**

Este documento es únicamente visible para los creadores de Talent ScoutTech y los integrantes de Individual Security. Este informe contiene información confidencial y sensible, por lo que no se podrá compartir con terceros sin el consentimiento de Talent ScoutTech o Individual Security.

## **Descargo de responsabilidad**

Una vez realizado el análisis de la aplicación proporcionada por Talent ScoutTech y con este informe como prueba de su realización junto a recomendaciones para arreglar o mejorar las vulnerabilidades detectadas, Individual Security no se hace responsable de malas interpretaciones o prácticas que puedan darse a raíz de la información proporcionada en este informe.

## **Información de contacto**

| Nombre | Cargo | Contacto \\ Email |
| ----- | :---- | :---- |
| **Talent ScoutTech** |  |  |
| Manuel Jesús Rivas Sández | Jefe Seguridad Informática | mrivsan736@g.educaand.es |
| **Individual Security** |  |  |
| Lucía Espinosa Sánchez | Penetration Tester | lespsan543@g.educaand.es |

## **Resumen de la evaluación**

Desde el martes 10 de diciembre de 2024 al 28 de enero de 2025, Individual Security se ha encargado de hacer un pentesting interno, con el fin de evaluar la seguridad de la red interna y determinar qué información y sistemas pueden ser accedidos sin autorización, destacando el análisis de vulnerabilidades. Este análisis está basado en la guía de OWASP.  
Los pasos principales que se han llevado a cabo durante el análisis son:

1. **Reconocimiento**: En esta fase se recolecta información pública sobre, en este caso, la aplicación.   
2. **Análisis de vulnerabilidades**: Tras obtener la información se analizan las vulnerabilidades o puntos sospechosos de la aplicación web.  
3. **Explotación**: Se simulan ataques reales para explotar las vulnerabilidades detectadas previamente.  
4. **Informe y reporte**: Una vez realizado el análisis completo, se realiza un informe con los detalles obtenidos tras la investigación y recomendaciones para mitigar las vulnerabilidades detectadas.

## **Índices de gravedad de los hallazgos**

| Gravedad | CVSS / Puntuación | Definición |
| ----- | ----- | ----- |
| Crítica | 9.0 \- 10.0 | Vulnerabilidad fácil de explotar, que puede dañar gravemente los datos o la estructura de la empresa, exponiendo información sensible. Se necesita una actuación inmediata. |
| Alta | 7.0 \- 8.9 | Vulnerabilidad que puede producir un impacto grave en la empresa pero su explotación es algo más compleja. Debe solucionarse lo antes posible. |
| Moderada | 5.0 \- 6.9 | Vulnerabilidad que no puede ser explotada o que tiene una gran complejidad. Solucionar cuando no haya vulnerabilidades de una gravedad superior. |
| Baja | 1.0 \- 4.9 | Vulnerabilidad que no puede ser explotada pero que es recomendable mitigar. No se necesita actuación a corto plazo pero a tener en cuenta en futuros parches que se vayan a aplicar. |
| Informacional | N/A | No existe una vulnerabilidad. Información adicional que se ha encontrado durante el análisis para que pueda tenerse en cuenta  |

## **Factores de riesgo**

El riesgo se basa en 2 factores:

* Probabilidad: Se basa en el potencial que tiene una vulnerabilidad de ser explotada.  
* Impacto: Se basa en las consecuencias que puede conllevar una vulnerabilidad.

Teniendo en cuenta esto, este es el impacto y la probabilidad de cada una de las vulnerabilidades encontradas:
+ SQLi:
  - Probabilidad: Media.
  - Impacto: Alto.
+ XSS:
  - Probabilidad: Media.
  - Impacto: Alto.
+ Exposición de datos sensibles:
  - Probabilidad: Baja.
  - Impacto: Alto.
+ Diseño inseguro:
  - Probabilidad: Alta.
  - Impacto: Alto.

## **Alcance**

El alcance del análisis incluye el Frotend y el Backend de la aplicación, que se encuentran en las siguientes URLs:

* Web_Talent-ScoutTech.zip  
   
El cliente no ha especificado ninguna exclusión.

## **Resumen ejecutivo**

El análisis se ha realizado entre el 10 de diciembre de 2024 y el 28 de enero de 2025, intentando encontrar el mayor número de vulnerabilidades posibles para notificar a la empresa de las mismas y que puedan mitigarlas cuanto antes.
Una vez analizada la web, se comenzó probando la inyección SQL en el campo del login, comprobando que la vulnerabilidad existe. A continuación, se realizaron pruebas en los campos de texto que se han encontrado en la web para probar a inyectar código JavaScript, consiguiendo insertar una alerta.
Posteriormente, comprobando los directorios de la web, se ha encontrado la carpeta "private", la cual se puede acceder sin ningún tipo de autenticación.
Finalmente se ha realizado una revisión del código fuente de la web, observando un diseño inseguro debido a la falta de sesiones para la autenticación de los usuarios.

## **Resumen e informe de vulnerabilidades**

| Vulnerabilidad | Gravedad | Recomendaciones |
| ----- | ----- | ----- |
| 1\. SQLi | Alta | Arreglar el código fuente de la web, controlando los caracteres que puede utilizar el usuario. |
| 2 \. XSS | Alta | Arreglar el código fuente de la web para escapar la salida antes de mostrar el HTML. |
| 3 \. Exposición de datos sensibles | Moderada | Configurar restricciones en el archivo .htaccess. |
| 4 \. Diseño inseguro | Crítica | Implementar sesiones para los usuarios. |

## **Resultados técnicos**

### **1\. SQLi**

| Descripción de la vulnerabilidad | Vulnerabilidad de inyección SQL, mediante la cual un atacante podría enviar una consulta y recuperar toda la información almacenada en la base de datos. |
| :---- | :---- |
| **CVE / CWE** | [CVE-2024-8465](https://nvd.nist.gov/vuln/detail/CVE-2024-8465) |
| **CVSS v3** | [7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-8465&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N&version=3.1&source=NIST) |
| **Gravedad** | Alta |
| **Impacto** | El usuario que encuentre esta vulerabilidad puede obtener datos sensibles de la base de datos. |
| **Sistemas afectados** | Web_Talent-ScoutTech.zip  |
| **Prueba de conceptos** | ![Imagen 10](/pictures/10.png)  ![Imagen 8](/pictures/8.png) |
| **Mitigación** | Arreglar el código fuente de la web, controlando los caracteres que puede utilizar el usuario. |

### **2 \. XSS**

| Descripción de la vulnerabilidad | El atacante puede inyectar código JavaScript en los campos de texto. |
| :---- | :---- |
| **CVE / CWE** | [CVE-2024-29184](https://nvd.nist.gov/vuln/detail/CVE-2024-29184) |
| **CVSS v3** | [8](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?name=CVE-2024-29184&vector=AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H&version=3.1&source=GitHub,%20Inc.) |
| **Gravedad** | Alta |
| **Impacto** | El usuario puede inyectar código JavaScript, utilizando las funciones que otorga este lenguaje para obtener datos o provocar errores. |
| **Sistemas afectados** | Web_Talent-ScoutTech.zip  |
| **Prueba de conceptos** | ![Imagen 12](/pictures/12.png) |
| **Mitigación** | Arreglar el código fuente de la web para escapar la salida antes de mostrar el HTML. |

### **3 \. Exposición de datos sensibles**

| Descripción de la vulnerabilidad | Puede accederse a la carpeta "private" sin ningún tipo de autenticación. |
| :---- | :---- |
| **CVE / CWE** | [CWE-548](https://cwe.mitre.org/data/definitions/548.html) |
| **CVSS v3** | [6.1](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:H/RL:X/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:L/MPR:N/MUI:N/MS:U/MC:L/MI:X/MA:X&version=3.1) |
| **Gravedad** | Moderada |
| **Impacto** | El atacante puede acceder a archivos privados que se encuentren en dicha carpeta. |
| **Sistemas afectados** | Web_Talent-ScoutTech.zip  |
| **Prueba de conceptos** | ![Imagen 18](/pictures/18.png) |
| **Mitigación** | Configurar restricciones en el archivo .htaccess, el cual si no existe debe crearse añadiendo la ruta del archivo que contendrá el usuario y la contraseña, el cual se crea ejecutando el comando “htpasswd -c Filename username” |

### **4 \. Diseño inseguro**

| Descripción de la vulnerabilidad | Diseño inseguro del código fuente de la web, relacionado con el uso de credenciales o métodos de autenticación. |
| :---- | :---- |
| **CVE / CWE** | [CWE-1348](https://cwe.mitre.org/data/definitions/1348.html) |
| **CVSS v3** | [9.8](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:X/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:L/MPR:N/MUI:N/MS:U/MC:H/MI:H/MA:X&version=3.1) |
| **Gravedad** | Crítica |
| **Impacto** | El atacante podría llegar a impersonar a un usuario legítimo o conseguir sus credenciales. |
| **Sistemas afectados** | Web_Talent-ScoutTech.zip  |
| **Prueba de conceptos** | ![Imagen 16](/pictures/16.png) |
| **Mitigación** | Implementar sesiones para los usuarios, para mejorar la seguridad de la autenticación de los mismos. |

## Conclusión

Una vez finalizado el análisis de la web y probadas las vulnerabilidades, se puede confirmar que la página tiene debilidades graves que deberían ser mitigadas cuanto antes, para así evitar la exposición de datos sensibles de los usuarios que están dados de alta en la web y que puedan confiar en la seguridad de la misma.
